<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0025)http://nemerle.org/About/ -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>
	Grok properties, indexers, delegates and events
</title>
    <link type="text/css" rel="stylesheet" href="static/style.css">
    <link type="text/css" rel="stylesheet" href="static/theme-default.css">
    <link type="text/css" rel="stylesheet" href="static/pygments.css">
<body>
        <table border="0" cellpadding="0" cellspacing="0">
            <tbody><tr class="header">
                <td>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                            <td width="100px"></td>
                            <td>
                                <table border="0" cellpadding="0" cellspacing="0">
                                    <tbody><tr>
                                        <td width="110px"></td>
                                        <td width="170px">
                                            <a href="./static/About - Nemerle programming language official site.htm"><img src="./static/logo.png"></a>
                                        </td>
                                        <td width="31px">
                                            <a href="./static/About - Nemerle programming language official site.htm"><img src="./static/ribbon.png"></a>
                                        </td>
                                        <td align="right" valign="bottom">
                                            <table border="0" cellpadding="0" cellspacing="0" class="menubar">
                                                <tbody><tr height="36">
                                                    <td class="menuitem">
                                                        <a href="http://nemerle.org/About/#"><img src="./static/menuitem-about-active-foreground.png"></a>
                                                    </td>
                                                    <td class="menuitem">
                                                        <a href="http://nemerle.org/wiki/index.php?title=Main_Page"><img src="./static/menuitem-wiki-inactive-foreground.png"></a>
                                                    </td>
                                                    <td class="menuitem">
                                                        <a href="http://groups.google.com/group/nemerle-en"><img src="./static/menuitem-forum-inactive-foreground.png"></a>
                                                    </td>
                                                    <td class="menuitem">
                                                        <a href="http://code.google.com/p/nemerle/downloads/list"><img src="./static/menuitem-downloads-inactive-foreground.png"></a>
                                                    </td>
                                                    <td>
                                                        <a href=""><img src="./static/menuitem-search-inactive-foreground.png"></a>
                                                    </td>
                                                </tr>
                                                <tr height="8">
                                                    <td colspan="4"></td>
                                                </tr>
                                            </tbody></table>
                                        </td>
                                    </tr>
                                </tbody></table>
                            </td>
                            <td width="100px">
                            </td>
                        </tr>
                    </tbody></table>
                </td>
            </tr>
            <tr class="body">
                <td>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                            <td width="100px">
                                &nbsp;
                            </td>
                            <td class="content">
                                <div>
                                    
<div align="right">
</div>

<p>
This page is a part of the <a class="internal present" href="/Grokking-Nemerle.html">Grokking Nemerle</a> tutorial.</p>

<table id="toc" class="toc" summary="Contents"><tr><td><div>Table of Contents</div><ul><li><a href="#Properties">Properties</a></li><li><a href="#Indexers">Indexers</a></li><li><a href="#Delegates">Delegates</a></li><li><a href="#Events">Events</a></li></ul></td></tr></table><h2><span class="mw-headline" id="Properties"><a name="Properties" id="Properties">Properties</a></span></h2>

<p>Properties are syntactic sugar for get/set design pattern commonly found
in Java. Accessing a property looks like accessing a field, but under
the hood it is translated to a method call.</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Button</span> <span class="p">{</span>
  <span class="k">mutable</span> <span class="n">text</span> <span class="p">:</span> <span class="kt">string</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">Text</span> <span class="p">:</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="n">get</span> <span class="p">{</span> <span class="n">text</span> <span class="p">}</span>
    <span class="n">set</span> <span class="p">{</span> <span class="n">text</span> <span class="p">=</span> <span class="n">value</span><span class="p">;</span> <span class="n">Redraw</span> <span class="p">()</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">def</span> <span class="n">b</span> <span class="p">=</span> <span class="n">Button</span> <span class="p">();</span>
<span class="n">b</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">b</span><span class="p">.</span><span class="n">Text</span> <span class="p">+</span> <span class="s">"..."</span>
</pre>
</div>


<h2><span class="mw-headline" id="Indexers"><a name="Indexers" id="Indexers">Indexers</a></span></h2>

<p>Indexers are another form of properties.
While regular properties expose field access syntax, indexers expose <i>array</i> access syntax instead:</p>

<div class="highlight"><pre><span class="k">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Table</span> <span class="p">{</span>
  <span class="n">store</span> <span class="p">:</span> <span class="kt">array</span> <span class="p">[</span><span class="kt">array</span> <span class="p">[</span><span class="kt">string</span><span class="p">]];</span>
  <span class="k">public</span> <span class="n">Item</span> <span class="p">[</span><span class="n">row</span> <span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">column</span> <span class="p">:</span> <span class="kt">int</span><span class="p">]</span> <span class="p">:</span> <span class="kt">string</span>
  <span class="p">{</span>
    <span class="n">get</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">set</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">=</span> <span class="n">value</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="nf">this</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">m</span> <span class="p">:</span> <span class="kt">int</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">store</span> <span class="p">=</span> <span class="kt">array</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">mutable</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">!=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
          <span class="n">store</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="kt">array</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">def</span> <span class="n">t</span> <span class="p">=</span> <span class="n">Table</span> <span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">);</span>
<span class="n">t</span><span class="p">.</span><span class="n">Item</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">;</span>
<span class="n">WriteLine</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">Item</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]);</span>
</pre>
</div>


<p>In .NET, a class can have a <i>default indexer name</i>,
making it unnecessary for that name to be explicitly used.
The current release of Nemerle always defines <code>Item</code> as the default,
so the code above can be simplified to</p>

<div class="highlight"><pre><span class="k">def</span> <span class="n">t</span> <span class="p">=</span> <span class="n">Table</span> <span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">);</span>
<span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">;</span>
<span class="n">WriteLine</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]);</span>
</pre>
</div>


<p>A class can have several indexers, but only one indexer name is considered the default.
That name, however, can be overloaded:</p>

<div class="highlight"><pre><span class="k">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">Table</span> <span class="p">{</span>
  <span class="n">store</span> <span class="p">:</span> <span class="kt">array</span> <span class="p">[</span><span class="kt">array</span> <span class="p">[</span><span class="kt">string</span><span class="p">]];</span>
  <span class="k">public</span> <span class="n">Item</span> <span class="p">[</span><span class="n">row</span> <span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">column</span> <span class="p">:</span> <span class="kt">int</span><span class="p">]</span> <span class="p">:</span> <span class="kt">string</span>
  <span class="p">{</span>
    <span class="n">get</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">set</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">=</span> <span class="n">value</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="n">Item</span> <span class="p">[</span><span class="n">row</span> <span class="p">:</span> <span class="kt">int</span><span class="p">]</span> <span class="p">:</span> <span class="kt">array</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span>
  <span class="p">{</span>
    <span class="n">get</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">set</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="p">=</span> <span class="n">value</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="n">SomeOtherIndexerName</span><span class="p">[</span><span class="n">row</span> <span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">column</span> <span class="p">:</span> <span class="kt">int</span><span class="p">]</span> <span class="p">:</span> <span class="kt">string</span>
  <span class="p">{</span>
    <span class="n">get</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">set</span> <span class="p">{</span> <span class="n">store</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="p">=</span> <span class="n">value</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="nf">this</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">m</span> <span class="p">:</span> <span class="kt">int</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">store</span> <span class="p">=</span> <span class="kt">array</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">mutable</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">!=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
          <span class="n">store</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="kt">array</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">def</span> <span class="n">t</span> <span class="p">=</span> <span class="n">Table</span> <span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">);</span>
<span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">;</span>
<span class="n">t</span><span class="p">.</span><span class="n">SomeOtherIndexerName</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="s">"foo"</span><span class="p">;</span>
<span class="n">WriteLine</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]);</span>
<span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">=</span> <span class="kt">array</span> <span class="p">[</span> <span class="s">"this"</span><span class="p">,</span> <span class="s">"is"</span><span class="p">,</span> <span class="s">"a"</span><span class="p">,</span> <span class="s">"new"</span><span class="p">,</span> <span class="s">"array"</span> <span class="p">];</span>
<span class="k">def</span> <span class="n">row2</span> <span class="p">=</span> <span class="n">t</span><span class="p">[</span><span class="m">2</span><span class="p">];</span>
<span class="n">WriteLine</span><span class="p">(</span><span class="n">row2</span><span class="p">[</span><span class="m">3</span><span class="p">]);</span>
</pre>
</div>


<p>Note that, while the current release of Nemerle always assumes <code>Item</code> to be the default indexer in user-defined classes,
this is not so in general for .NET indexers.
For example, the <code>System.Hashtable</code> default indexer is called
<code>Item</code> and <code>System.String</code> one is called <code>Chars</code>.
As mentioned above, Nemerle (like VB.NET) allows the definition of several indexers with possibly different names.
C#, on the other hand, only allows the definition of the default indexer.</p>

<h2><span class="mw-headline" id="Delegates"><a name="Delegates" id="Delegates">Delegates</a></span></h2>

<p>Delegates are half-baked functional values. In fact there is little place
for usage of delegates in Nemerle itself. However other .NET languages
all speak delegates, so they are a good way to expose functional values
for them and <i>vice versa</i>.</p>

<p>Delegates are in essence named functional types. They are defined with the
<code>delegate</code> keyword:</p>

<div class="highlight"><pre><span class="k">delegate</span> <span class="nf">Foo</span> <span class="p">(</span><span class="n">_</span> <span class="p">:</span> <span class="kt">int</span><span class="p">,</span> <span class="n">_</span> <span class="p">:</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="kt">void</span><span class="p">;</span>
<span class="k">delegate</span> <span class="nf">Callback</span> <span class="p">()</span> <span class="p">:</span> <span class="kt">void</span><span class="p">;</span>
</pre>
</div>


<p>Later the delegate name can be used to construct delegate instances. Any
functional value of corresponding type can be used to create a delegate
instance (local functions and lambda expressions in particular).</p>

<p>Delegate instance can be invoked using regular function call syntax,
as well as the <code>Invoke</code> special method. Please consult class library
documentation for details.</p>

<p>The <code>+=</code> operator has special meaning on delegate instances --
it calls the <code>System.Delegate.Combine</code> method that makes one
function that calls two other in sequence. This operator is probably
more useful with events.</p>

<div class="highlight"><pre><span class="k">module</span> <span class="nc">X</span> <span class="p">{</span>
  <span class="n">some_fun</span> <span class="p">()</span> <span class="p">:</span> <span class="kt">void</span>
  <span class="p">{</span>
    <span class="k">mutable</span> <span class="n">f</span> <span class="p">=</span> <span class="n">Foo</span> <span class="p">(</span><span class="k">fun</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="p">{});</span>
    <span class="n">f</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="s">"foo"</span><span class="p">);</span> <span class="c1">// same as f.Invoke (3, "foo");</span>
    <span class="n">f</span> <span class="p">+=</span> <span class="k">fun</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span> <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">};</span>
    <span class="n">f</span> <span class="p">(</span><span class="m">42</span><span class="p">,</span> <span class="s">"bar"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre>
</div>


<h2><span class="mw-headline" id="Events"><a name="Events" id="Events">Events</a></span></h2>

<p>Events are kind of specialized properties for delegates. They are used
in a GUI system for connecting signals (setting function to call when
a button is pressed etc.). They can be also used to call user defined
function on certain events, like class being loaded by the runtime system.</p>

<p>Events are defined like fields, but they are marked with the
<code>event</code> keyword, and always have a delegate type. Inside the class
events are seen as fields of these delegate type, but outside only the
<code>+=</code> and <code>-=</code> operators are available. They are used to
connect and disconnect delegates. Implicit conversion from functional
values to delegate instances is provided.</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">Button</span> <span class="p">{</span>
  <span class="k">public</span> <span class="k">event</span> <span class="n">OnClick</span> <span class="p">:</span> <span class="n">Callback</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">def</span> <span class="n">b</span> <span class="p">=</span> <span class="n">Button</span> <span class="p">();</span>
<span class="n">b</span><span class="p">.</span><span class="n">OnClick</span> <span class="p">+=</span> <span class="k">fun</span> <span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</pre>
</div>


                                </div>
                        </td>
                        <td width="100px">
                            &nbsp;
                        </td>
                    </tr>
                </tbody></table>
            </td>
        </tr>
            <tr class="footer">
                <td>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                            <td colspan="2">
                                &nbsp;&nbsp;© 2011 <a href="http://code.google.com/p/nemerle/people/list">Nemerle Project Team</a>&nbsp;&nbsp;This site is hosted and maintained by <a href="http://rsdn.ru/">Russian Software Development Network</a> team
                            </td>
                            <td width="100px" align="right">
                                <a href="http://www.opensource.org/licenses/bsd-license.php">Legal&nbsp;statements</a>&nbsp;&nbsp;
                            </td>
                        </tr>
                    </tbody></table>
                </td>
            </tr>
            <tr class="shadow">
                <td>
                    <table border="0" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                            <td width="100px"></td>
                            <td class="shadow">
                                <img src="./static/shadow-foreground.png">
                            </td>
                            <td width="100px"></td>
                        </tr>
                    </tbody></table>
                </td>
            </tr>
        </tbody></table>
</body></html>